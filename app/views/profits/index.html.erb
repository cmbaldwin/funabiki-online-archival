<%= turbo_frame_tag 'app' do %>
  <% title "Funabiki Online - 計算表" %>

  <%= render 'profits/shared/profit_calendar_modal', locals: { new_profit: true } %>
  <%= render 'profits/shared/profit_calendar_modal', locals: { new_profit: false } %>
  <%= render 'profits/shared/volumes_modal', locals: { profit: @profit } %>

  <%= turbo_frame_tag 'profit_index' do %>
    <div class="container">
      <div class="row align-middle">
        <div class="col">

          <div class="btn-group float-end" role="group" aria-label="Basic">
            <button id="newProfitModalButton" type="button" class="btn btn-info" data-bs-toggle="modal" data-bs-target="#newProfitModal">
              <span class="tippy" data-tippy-content="計算表を追加" data-controller="tippy">
                <%= icon('plus-circle-fill', class: 'text-success') %>
              </span>
            </button>
            <button id="ProfitModalButton" type="button" class="btn btn-info" data-bs-toggle="modal" data-bs-target="#ProfitModal">
              <span  class="tippy" data-tippy-content="計算表をカレンダーで調べる" data-controller="tippy">
                <%= icon('calendar3') %>
              </span>
            </button>
          </div>

          <hr/>

          <h1>計算表</h1>

        </div>
      </div>

      <hr/>

      <% @profits.each do |profit| %>
        <% row_type = if profit.ampm == nil 
                        'day_row' 
                      elsif profit.ampm == true 
                        'ampm_row am_row' 
                      elsif profit.ampm == false
                        'ampm_row pm_row'
                      end %>
        <%= turbo_frame_tag dom_id(profit), 
                            src: index_profit_profit_path(profit), 
                            loading: 'lazy',
                            class: "row mx-2 small profit_index_row justify-content-around align-content-center align-middle #{row_type} #{cycle('even', 'odd')}" do %> 
          <div class="col-12 text-center">
            <div class="spinner-border spinner-border-sm" role="status">
              <span class="visually-hidden">読み込み中...</span>
            </div>
          </div>
        <% end %> 
      <% end %>
      <%= will_paginate @profits %>
    </div>
  <% end %>
<% end %>